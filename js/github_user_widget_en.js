function appendToWidget(e,t,i,a){e=document.querySelector(e),(t=document.createElement(t)).innerHTML=a,t.className+=i,e.appendChild(t)}function getJSON(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onload=function(){if(200===i.status){var e=JSON.parse(i.responseText);t(e)}},i.send()}function ready(e){"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function start(){appendToWidget("body","style","","@import url(https://fonts.googleapis.com/css?family=Noto+Sans:400,700);.gh-widget-link,.gh-widget-link:hover{text-decoration:none}.gh-widget-container{display:flex;flex-direction:row;flex-wrap:no-wrap;align-items:center;justify-content:center;color:#333;font-family:'Noto Sans',sans-serif}.gh-widget-personal-details .bio{color:#222222l;} .gh-widget-stats .count{color:#4078C0}.github-widget{border:1px solid #DDD;max-width:350px}.gh-widget-item{flex:1;text-align:center;padding:10px}.gh-widget-repositories .language{text-align:left}.gh-widget-repositories .language div,.gh-widget-repositories .stars div{padding:5px 0}.gh-widget-photo{flex:2}.gh-widget-photo img{border-radius:100%;max-width:80px}.gh-widget-personal-details{flex:6}.gh-widget-personal-details .full-name{font-size:1.5em;line-height:1.5em}.gh-widget-personal-details .location{font-size:.8em}.gh-widget-stats .count{font-size:1.2em;font-weight:700}.gh-widget-repositories .names{flex:2;text-align:left}.gh-widget-repositories .names div{padding:5px 0;text-overflow:ellipsis}.gh-widget-follow{flex:2}.gh-widget-active-time{flex:4;font-size:.8em}.gh-widget-heading{font-weight:400;color:#666}.gh-widget-hr{border:1px solid #DDD}.gh-widget-link{color:#4078C0}.gh-widget-follow button{width:100%;height:2em;border:none;background:#ddd} img{ vertical-align:middle;} .github-box-title{position:relative;border-bottom:1px solid #DDD;border-radius:3px 3px 0 0;background:#FCFCFC;background:-moz-linear-gradient(#FCFCFC,#EBEBEB);background:-webkit-linear-gradient(#FCFCFC,#EBEBEB);}");for(var e=document.querySelectorAll(".github-widget"),t=0;t<e.length;t++){var i=e[t];i.setAttribute("id","widget"+t),appendToWidget("#widget"+t,"div","",'<div class="gh-widget-container"><div class="gh-widget-item gh-widget-photo"></div><div class="gh-widget-item gh-widget-personal-details"></div></div><div class="gh-widget-container gh-widget-stats"></div><hr class="gh-widget-hr"><div class="gh-widget-container"><div class="gh-widget-item gh-widget-heading">Popular Repositories</div></div><div class="gh-widget-repositories"></div><div class="gh-widget-container"><div class="gh-widget-item gh-widget-follow"></div><div class="gh-widget-item gh-widget-active-time"></div></div>'),fetchRepos(i=i.dataset.username,"#widget"+t),fetchUserDetails(i,"#widget"+t)}}function fetchRepos(e,t){getJSON("https://api.github.com/users/"+e+"/repos",function(e){updateRepoDetails(topRepos(e),t),updateLastPush(lastPushedDay(e),t)})}function fetchUserDetails(e,t){getJSON("https://api.github.com/users/"+e,function(e){updateUserDetails(e,t)})}function updateLastPush(e,t){appendToWidget(t+" .gh-widget-active-time","span","","Last active: "+(e?e+" day(s) ago":"Today"))}function lastPushedDay(e){for(var t,i=new Date,a=9999999999999,d=0;d<e.length;d++){var o=new Date(e[d].pushed_at);i-o<a&&(t=o,a=i-o)}return Math.floor((i-t)/864e5)}function updateUserDetails(e,t){appendToWidget(t+" .gh-widget-personal-details","div","full-name",'<a class="gh-widget-link" target="new" href="'+e.html_url+'">'+e.name+"</a>"),e.bio&&appendToWidget(t+" .gh-widget-personal-details","div","bio",e.bio),e.location&&appendToWidget(t+" .gh-widget-personal-details","div","location",'<img src="http://www.iconres.com/android/res/material_icons/external-assets/v4/icons/png/ic_location_on_black_48dp.png" width=20 height=20 />'+e.location),e.email&&appendToWidget(t+" .gh-widget-personal-details","div","email",'<img src="http://www.iconres.com/android/res/material_icons/external-assets/v4/icons/png/ic_email_black_48dp.png" width=20 height=20 />'+e.email),appendToWidget(t+" .gh-widget-stats","div","gh-widget-item",'<div class="count"><a class="gh-widget-link" target="new" href="'+e.html_url+'/followers">'+e.followers+'</a></div><div class="stat-name">Followers</div>'),appendToWidget(t+" .gh-widget-stats","div","gh-widget-item",'<div class="count"><a class="gh-widget-link" target="new" href="'+e.html_url+'/following">'+e.following+'</a></div><div class="stat-name">Following</div>'),appendToWidget(t+" .gh-widget-stats","div","gh-widget-item",'<div class="count"><a class="gh-widget-link" target="new" href="'+e.html_url+'/?tab=repositories">'+e.public_repos+'</a></div><div class="stat-name">Repositories</div>'),appendToWidget(t+" .gh-widget-photo","span","",'<img src="'+e.avatar_url+'">'),appendToWidget(t+" .gh-widget-follow","button","",'<a class="gh-widget-link" target="new" href="'+e.html_url+'">Home</a>')}function updateRepoDetails(e,t){for(var i=0;i<e.length;i++)appendToWidget(t+" .gh-widget-repositories","div","gh-widget-container",'<div class="gh-widget-item names"><div><a class="gh-widget-link" href="'+e[i].repoUrl+'">'+e[i].name+'</a></div></div><div class="gh-widget-item language"><div>'+(e[i].language?e[i].language:"Unknown")+'</div></div><div class="gh-widget-item stars"><div>&#9733;'+e[i].stars+"</div></div>")}function topRepos(e){e.sort(function(e,t){return e.stargazers_count===t.stargazers_count?0:e.stargazers_count>t.stargazers_count?-1:1}),e=e.slice(0,3);var t,i=[];for(t in e){var a=e[t];i.push({name:a.name,stars:a.stargazers_count,language:a.language,repoUrl:a.html_url})}return i}ready(start);